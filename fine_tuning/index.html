
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Document Forensics Solution Documentation">
      
      
        <meta name="author" content="Nivratti Boyane">
      
      
      
        <link rel="prev" href="../api_documentation/">
      
      
        <link rel="next" href="../dataset_composition/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Fine-tuning - DocForensics</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model-fine-tuning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DocForensics" class="md-header__button md-logo" aria-label="DocForensics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DocForensics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fine-tuning
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DocForensics" class="md-nav__button md-logo" aria-label="DocForensics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DocForensics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../input_image_requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Image Requirements
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Fine-tuning
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Fine-tuning
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fine-tuning-document-tampering-localization-model" class="md-nav__link">
    <span class="md-ellipsis">
      Fine-Tuning Document Tampering Localization model:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fine-Tuning Document Tampering Localization model:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataset-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset Requirements:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    <span class="md-ellipsis">
      Steps:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-crop-id-cards" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Crop ID cards
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Crop ID cards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-orientation-correction" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Orientation correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-split-the-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Split the Dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-generate-tampering-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Generate tampering dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Generate tampering dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage_1" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax_1" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Example Commands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-run-model-fine-tuning-script" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Run Model Fine-Tuning Script
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Run Model Fine-Tuning Script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage_2" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax_2" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-command" class="md-nav__link">
    <span class="md-ellipsis">
      Example Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-export-model" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Export model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 6: Export model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage_3" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax_3" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-command_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_composition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataset Composition
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding_document_forensics_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding Document Forensics Workflow
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fine-tuning-document-tampering-localization-model" class="md-nav__link">
    <span class="md-ellipsis">
      Fine-Tuning Document Tampering Localization model:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fine-Tuning Document Tampering Localization model:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataset-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset Requirements:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    <span class="md-ellipsis">
      Steps:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-crop-id-cards" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Crop ID cards
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Crop ID cards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-orientation-correction" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Orientation correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-split-the-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Split the Dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-generate-tampering-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Generate tampering dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Generate tampering dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage_1" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax_1" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Example Commands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-run-model-fine-tuning-script" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Run Model Fine-Tuning Script
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Run Model Fine-Tuning Script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage_2" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax_2" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-command" class="md-nav__link">
    <span class="md-ellipsis">
      Example Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-export-model" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Export model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 6: Export model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-line-usage_3" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Command Line Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-syntax_3" class="md-nav__link">
    <span class="md-ellipsis">
      General Syntax
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-command_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example Command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="model-fine-tuning">Model Fine-Tuning</h1>
<h2 id="fine-tuning-document-tampering-localization-model">Fine-Tuning Document Tampering Localization model:</h2>
<p>You can fine-tune the forensics model for the following purposes:</p>
<ol>
<li>
<p><strong>Adding Support for New Card Types</strong>: Extend the model's capabilities to handle previously unsupported card types by training it on new datasets specific to those cards.</p>
</li>
<li>
<p><strong>Improving Performance on Existing Card Types</strong>: Enhance the accuracy and reliability of tampering detection for currently supported card types by fine-tuning the model with additional high-quality data.</p>
</li>
</ol>
<h3 id="dataset-requirements">Dataset Requirements:</h3>
<p>To enhance support for new card types, ensure you collect authentic <strong>at least 30 unique, high-quality images</strong> of the new card type.</p>
<h3 id="tutorials">Tutorials</h3>
<p>Watch the video tutorial on fine-tuning the document forensic model:</p>
<ul>
<li><a href="https://drive.google.com/file/d/1ZeHLxIoqGcjD5GMREQUL9em7FBiDgSY4/view?usp=drive_link">Google Drive Link</a>  </li>
<li><a href="https://github.com/Nivratti/doc_forensics_train/releases/download/v4.0/Finetuning-Document-forensic-model.mp4">GitHub Release Link</a></li>
</ul>
<h3 id="steps">Steps:</h3>
<h4 id="step-1-crop-id-cards">Step 1: Crop ID cards</h4>
<p>Crop ID cards to isolate the ID card region from the background, retaining only the ID card region. The current card segmentation model supports PAN cards and Mauritius ID cards. For other card types, you can either search for a pre-trained model online or manually crop the ID card region.</p>
<h5 id="command-line-usage">Command Line Usage</h5>
<p>This section explains how to use the <code>inference_card_segmentation.py</code> script from the command line.</p>
<p>Download the <code>card_segmentation.zip</code> file from the following link: <a href="https://github.com/Nivratti/doc_forensics_train/releases/tag/v4.0">card segmentation model</a></p>
<p>After downloading, extract the contents into the <code>./resources/models</code> folder. Once extracted, the model path will be:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>./resources/models/card_segmentation/v8.0.1/best.onnx
</span></code></pre></div></p>
<h6 id="general-syntax">General Syntax</h6>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>python<span class="w"> </span>inference_card_segmentation.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">   </span>--input_dir<span class="w"> </span><span class="s2">&quot;&lt;path_to_input_directory&gt;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">   </span>--output_dir<span class="w"> </span><span class="s2">&quot;&lt;path_to_output_directory&gt;&quot;</span>
</span></code></pre></div>
<ul>
<li><strong><code>--input_dir</code></strong>: Path to the folder containing input files (e.g., raw ID card images).</li>
<li><strong><code>--output_dir</code></strong>: Path to the folder where processed outputs will be saved.</li>
</ul>
<h6 id="example">Example</h6>
<ol>
<li>Processing Mauritius ID Cards
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>python<span class="w"> </span>inference_card_segmentation.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">   </span>--input_dir<span class="w"> </span><span class="s2">&quot;datasets/raw/Mauritius-id-nic-v1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">   </span>--output_dir<span class="w"> </span><span class="s2">&quot;datasets/processed/Mauritius-id-card/card-det-res&quot;</span>
</span></code></pre></div></li>
</ol>
<h4 id="step-2-orientation-correction">Step 2: Orientation correction</h4>
<p>Correct the orientation of the ID card images, if necessary, to ensure they are upright and properly aligned.</p>
<h4 id="step-3-split-the-dataset">Step 3: Split the Dataset</h4>
<p>Split the collected images into training and validation sets, using an 80:20 ratio as a default or another ratio of your choice. This means 80% of the images will be used for training, while the remaining 20% will be used for validation. You can create folders named <code>train</code> and <code>val</code> to store the respective data.</p>
<h4 id="step-4-generate-tampering-dataset">Step 4: Generate tampering dataset</h4>
<p>Generate a tampering dataset by running the data generation script. Ensure to run the script separately for the training and validation sets.</p>
<p>The input for the script will be the cropped and split datasets you have prepared earlier. It will produce a tampered image and a corresponding mask for every original image.</p>
<p>For each original image, it generates three outputs with specific postfixes added to the filenames:</p>
<ol>
<li>Original Image: with <code>_orig.jpeg</code> postfix.  </li>
<li>Tampered Image: with <code>_tampered.jpeg</code> postfix.  </li>
<li>Mask: with <code>_mask.png</code> postfix.</li>
</ol>
<p>For example, the output files will follow this naming convention:</p>
<ul>
<li><code>11_orig.jpeg</code>, <code>11_tampered.jpeg</code>, <code>11_mask.png</code></li>
<li><code>12_orig.jpeg</code>, <code>12_tampered.jpeg</code>, <code>12_mask.png</code></li>
<li><code>13_orig.jpeg</code>, <code>13_tampered.jpeg</code>, <code>13_mask.png</code></li>
</ul>
<h5 id="command-line-usage_1">Command Line Usage</h5>
<p>Use the following syntax and examples to run the script from the command line.</p>
<h6 id="general-syntax_1">General Syntax</h6>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>python<span class="w"> </span>data_gen_wrapper.py<span class="w"> </span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">   </span>--source_dir<span class="w"> </span><span class="s2">&quot;&lt;path_to_source_directory&gt;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">   </span>--out_dir<span class="w"> </span><span class="s2">&quot;&lt;path_to_output_directory&gt;&quot;</span>
</span></code></pre></div>
<ul>
<li><strong><code>--source_dir</code></strong>: Path to the source directory containing the cropped and split datasets (e.g., training or validation sets).</li>
<li><strong><code>--out_dir</code></strong>: Path to the output directory where the tampered images and masks will be saved.</li>
</ul>
<h6 id="example-commands">Example Commands</h6>
<ol>
<li>
<p>For generating Training Dataset
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>python<span class="w"> </span>data_gen_wrapper.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">   </span>--source_dir<span class="w"> </span><span class="s2">&quot;./datasets/processed/Mauritius-id-card/split_cropped/train/&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">   </span>--out_dir<span class="w"> </span><span class="s2">&quot;./datasets/data_gen/Mauritius-id-card/train&quot;</span>
</span></code></pre></div></p>
</li>
<li>
<p>For generating Validation Dataset
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>python<span class="w"> </span>data_gen_wrapper.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">   </span>--source_dir<span class="w"> </span><span class="s2">&quot;./datasets/processed/Mauritius-id-card/split_cropped/val/&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">   </span>--out_dir<span class="w"> </span><span class="s2">&quot;./datasets/forensic_data_gen/Mauritius-id-card/val&quot;</span>
</span></code></pre></div></p>
</li>
</ol>
<p>By running these commands, tampered images and their corresponding masks will be generated and stored in the specified output directories.</p>
<h4 id="step-5-run-model-fine-tuning-script">Step 5: Run Model Fine-Tuning Script</h4>
<p>To fine-tune the model, execute the provided <code>main.py</code> script from the command line. This script will fine-tune your model using the specified training and testing datasets.</p>
<h5 id="command-line-usage_2">Command Line Usage</h5>
<h6 id="general-syntax_2">General Syntax</h6>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>python<span class="w"> </span>main.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span>--data_path<span class="w"> </span><span class="s2">&quot;&lt;path_to_training_data&gt;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span>--test_data_path<span class="w"> </span><span class="s2">&quot;&lt;path_to_testing_data&gt;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span>--output_dir<span class="w"> </span><span class="s2">&quot;&lt;path_to_model_output&gt;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span>--weights_path<span class="w"> </span><span class="s2">&quot;&lt;path_to_weights_file&gt;&quot;</span>
</span></code></pre></div>
<ul>
<li><strong><code>--data_path</code></strong>: Path to the folder containing the training dataset (e.g., images and masks).</li>
<li><strong><code>--test_data_path</code></strong>: Path to the folder containing the testing dataset for evaluation during fine-tuning.</li>
<li><strong><code>--output_dir</code></strong>: (Optional) Path to the directory where the fine-tuned model and logs will be saved.</li>
<li><strong><code>--weights_path</code></strong>: (Optional) Path to the pre-trained weights file. The default value is <code>./ckpt/v8.0/best_model.pth</code>. You can change this path based on your requirements.</li>
</ul>
<p>To download the <code>v8.0/best_model.pth</code> file use the following link: <a href="https://github.com/Nivratti/DocForensics_Mauritius_Inference/releases/download/v8.0/best_model.pth">v8.0/best_model.pth</a></p>
<h5 id="example-command">Example Command</h5>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>python<span class="w"> </span>main.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span>--data_path<span class="w"> </span><span class="s2">&quot;./datasets/data_gen/Mauritius-id-card/train/&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span>--test_data_path<span class="w"> </span><span class="s2">&quot;./datasets/data_gen/Mauritius-id-card/val/&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span>--output_dir<span class="w"> </span><span class="s2">&quot;./output/training/v8.1&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span>--weights_path<span class="w"> </span><span class="s2">&quot;./ckpt/v8.0/best_model.pth&quot;</span>
</span></code></pre></div>
<h5 id="output">Output</h5>
<ul>
<li><code>Fine-Tuned Model</code>: The updated model file will be saved in the specified <code>--output_dir</code>.</li>
<li><code>Fine-Tuning Logs</code>: Logs containing metrics such as loss, accuracy, and validation performance will be saved for further analysis.</li>
</ul>
<h5 id="notes">Notes</h5>
<ol>
<li>Ensure that the directories specified in <code>--data_path</code> and <code>--test_data_path</code> contain the correctly prepared datasets.</li>
<li>If you have specific pre-trained weights to use, provide the path using <code>--weights_path</code>. Otherwise, the default weights file will be used.</li>
<li>The <code>--output_dir</code> should be an empty or new directory to avoid overwriting existing files.</li>
</ol>
<h4 id="step-6-export-model">Step 6: Export model</h4>
<p>Once the fine-tuning process is complete, the trained PyTorch model can be exported to the <em>ONNX (Open Neural Network Exchange)</em> format for compatibility with other frameworks or deployment environments.</p>
<h5 id="command-line-usage_3">Command Line Usage</h5>
<h6 id="general-syntax_3">General Syntax</h6>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>python<span class="w"> </span>export.py<span class="w"> </span>--weights_path<span class="w"> </span><span class="s2">&quot;&lt;path_to_trained_model_weights&gt;&quot;</span><span class="w"> </span>--onnx_output_path<span class="w"> </span><span class="s2">&quot;&lt;path_to_save_onnx_model&gt;&quot;</span>
</span></code></pre></div>
<ul>
<li><em><code>--weights_path</code></em>: Path to the trained PyTorch model file (e.g., <code>.pth</code> file) that you want to export.</li>
<li><em><code>--onnx_output_path</code></em>: Path where the exported ONNX model will be saved.</li>
</ul>
<h5 id="example-command_1">Example Command</h5>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>python<span class="w"> </span>export.py<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span>--weights_path<span class="w"> </span><span class="s2">&quot;./output/training/v8.2/best_model.pth&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span>--onnx_output_path<span class="w"> </span><span class="s2">&quot;./output/training/v8.2/best_model.onnx&quot;</span>
</span></code></pre></div>
<h5 id="output_1">Output</h5>
<ul>
<li><em>ONNX Model File</em>: The exported ONNX model will be saved at the location specified by <code>--onnx_output_path</code>.</li>
</ul>
<h5 id="notes_1">Notes</h5>
<ol>
<li>Ensure the <code>--weights_path</code> points to the correct and finalized PyTorch model file from the fine-tuning step.</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../api_documentation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: API Documentation">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                API Documentation
              </div>
            </div>
          </a>
        
        
          
          <a href="../dataset_composition/" class="md-footer__link md-footer__link--next" aria-label="Next: Dataset Composition">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Dataset Composition
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate", "navigation.footer", "navigation.top", "navigation.instant", "navigation.instant.progress", "search.highlight"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>